# WOR Forecast

## Описание
`wor_forecast.py` представляет модель, построенную на работе
<https://doi.org/10.1155/2024/4584237> и предназначенную для прогнозирования
динамики обводненности (watercut) на основе исторических данных по добыче.

- **Класс `WOR_forecaster`**
  - Инициализация: рассчитывает вспомогательные параметры `M`, `c`, `a`.
  - `set_hist_data(df)`: загружает исторические данные (оптимизацию добычи и watercut) и формирует ключевой параметр КИН `R`.
  - `sw_calc(OR)`: вычисляет среднее насыщение и реальное насыщение на основе `lam`.
  - `lin_coef_calc(lam, R)`: формирует коэффициенты для логарифмического преобразования.
  - `watercut_from_wor(R, lam, nw, no)`: рассчитывает модельный watercut.
  - `get_dataframe()`: возвращает DataFrame с модельными и историческими значениями.
  - `limit_calc(nw, no, fw)`: вычисляет лимит КИН, при котором модель считается надёжной.
  - `wct_forecast()`: основной метод, подгоняющий модель, определяющий предел прогноза и генерирующий прогнозные значения.
  - `wct_fitting()`: использует `curve_fit` для оптимизации параметров `lam`, `nw`, `no`.
  - `plot_results(popt=None)`: визуализирует исторические и модельные данные, а также остатки подгонки.
  - `detailed_watercut_plot(df, show_statistics=True)`: продвинутая визуализация с разделением исторического и прогнозного периодов и выводом RMSE.

## Использование
```python
import pandas as pd
from wor_forecast import WOR_forecaster

# Загрузка данных
file_path = "/home/albert/Документы/decliner/test_data/test_wor_func.csv"
df = pd.read_csv(file_path)

# Создание объекта с параметрами
oil_f = WOR_forecaster(
    Swi=0.3,
    Sor=0.3,
    muo=2.47,
    muw=0.4,
    krw=0.2,
    kro=1,
    N=18680 * 2,
    lam=1.01,
)

# Установка исторических данных
oil_f.set_hist_data(df)

# Генерация прогноза
forecast_df = oil_f.wct_forecast()

# Визуализация
oil_f.detailed_watercut_plot(forecast_df)
```

### Вывод
Файл `forecast_df` содержит исторические данные, прогнозные значения и комментарии, которые можно сохранить в CSV, Excel или использовать для дальнейшего анализа.

---

**Автор**: Алёксей (Albert)
